"object"!=typeof wp.UM&&(wp.UM={}),"object"!=typeof wp.UM.profile_completeness&&(wp.UM.profile_completeness={is_profile_changed:!1,widget:{wrapper:{},build:function(t){wp.ajax.send("um_profile_completeness_get_widget",{data:{is_profile:t.data("is_profile"),user_id:t.data("user_id"),nonce:um_scripts.nonce},success:function(e){wp.UM.profile_completeness.widget.set_content(e),t.addClass("um-is-loaded"),init_tipsy()},error:function(e){console.error(e)}})},set_content:function(e){var t=wp.template("ultimatemember_profile_completeness");wp.UM.profile_completeness.widget.wrapper.html(t(e))}},popup:{init_plugins:function(e){e.find(".um-s1").select2({allowClear:!0,minimumResultsForSearch:10}),e.find(".um-datepicker").each(function(){var e=jQuery(this),t=!1;""!==e.attr("data-disabled_weekdays")&&(t=JSON.parse(e.attr("data-disabled_weekdays")));var o=e.attr("data-years"),s=e.attr("data-date_min"),i=e.attr("data-date_max");s=s.split(","),i=i.split(","),e.pickadate({selectYears:o,min:s,max:i,disable:t,format:e.attr("data-format"),formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()}})}),e.find(".um-timepicker").each(function(){var e=jQuery(this);e.pickatime({format:e.attr("data-format"),interval:parseInt(e.attr("data-intervals")),formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){e.blur()},onClose:function(){e.blur()}})}),wp.hooks.doAction("um_profile_completeness_popup_loaded",e)},load:function(e){var t=e.data("key");if(void 0===t||e.parents(".um-completeness-step").hasClass("completed")){if(!e.parents(".um-completeness-step").hasClass("is-core"))return!1}else prepare_Modal(),wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:t,nonce:um_scripts.nonce},success:function(e){show_Modal(e),responsive_Modal(),um_responsive(),wp.UM.profile_completeness.popup.init_plugins(jQuery(".um-popup"))},error:function(e){remove_Modal(),console.error(e)}})},save:function(i){var t,e=!0,o=i.find(".um-completeness-editwrap").find("input[type=text],input[type=radio],input[type=checkbox],textarea,select").attr("type"),n=i.find(".um-completeness-editwrap").find("input[type=text],input[type=radio],input[type=checkbox],textarea,select").attr("name");switch(n||(n=i.find(".um-completeness-editwrap").data("key")),i.find(".um-completeness-editwrap").find("select").length&&0===i.find(".um-completeness-editwrap").find(".picker").length&&(o="select",n=i.find(".um-completeness-editwrap").find("select").attr("id")),o){case"radio":(t=jQuery('input[name="'+n+'"]:checked').val())&&(e=!1);break;case"checkbox":t=[],jQuery('input[name="'+n+'"]:checked').each(function(e){t.push(jQuery(this).val())}),t&&(e=!1,t=t.join(", "));break;case"select":(t=jQuery("#"+n).val())&&(e=!1),jQuery(".um-popup select[multiple]").length&&t&&(e=!1,t=t.join(", "));break;default:void 0===(t=wp.hooks.applyFilters("um_profile_completeness_save_field_value",t,o,n,i))?(1===i.find(".um-completeness-editwrap").find("textarea").length&&(n=i.find(".um-completeness-editwrap").find("textarea").attr("id")),t=jQuery(".um-completeness-field #"+n).val(),i.find(".picker").length&&(t=jQuery("#"+n+"_hidden").val()||jQuery("#"+n).parents(".um-field-area").find("[type=hidden][name="+n+"]").val()),0<t.trim().length&&(e=!1)):e=!1}return n=(n=n.replace("[]","")).replace("um_completeness_widget_",""),e||!t?i.find('input[name="'+n+'"]').trigger("focus"):(i.addClass("um-visible-overlay"),wp.ajax.send("um_profile_completeness_save_popup",{data:{key:n,value:t,nonce:um_scripts.nonce},success:function(e){var t=jQuery('.um-completeness-bar[data-user_id="'+e.user_id+'"]');t.attr("original-title",e.percent+wp.i18n.__("% Complete","um-profile-completeness")),t.find(".um-completeness-done").animate({width:e.percent+"%"}),jQuery('.um-completeness-jx[data-user_id="'+e.user_id+'"]').html(e.percent),wp.UM.profile_completeness.is_profile_changed=!0,wp.UM.profile_completeness.widget.build(jQuery('.um-completeness-widget[data-user_id="'+e.user_id+'"]'));var o=jQuery(".um-completeness-step[data-key="+n+"]");o.addClass("completed");var s=o.next(".um-completeness-step:not(.completed,.is-core)").data("key");s?wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:s,nonce:um_scripts.nonce},success:function(e){i.removeClass("um-visible-overlay"),show_Modal(e),responsive_Modal(),um_responsive(),wp.UM.profile_completeness.popup.init_plugins(i)},error:function(e){remove_Modal(),console.error(e)}}):(remove_Modal(),void 0!==e.redirect&&""!==e.redirect?window.location=e.redirect:location.reload())},error:function(e){"object"==typeof e&&"string"==typeof e.error_message?(i.find(".um-field-error").remove(),i.find(".um-field-area").after('<div class="um-field-error"><span class="um-field-arrow"><i class="um-faicon-caret-up"></i></span>'+e.error_message+"</div>"),i.removeClass("um-visible-overlay")):(console.log(e),location.reload())}})),!1},skip:function(t){var e=jQuery(".um-completeness-editwrap").attr("data-key"),o=jQuery(".um-completeness-step[data-key="+e+"]").next(".um-completeness-step:not(.completed,.is-core)").attr("data-key");return t.addClass("um-visible-overlay"),o?wp.ajax.send("um_profile_completeness_edit_popup",{data:{key:o,nonce:um_scripts.nonce},success:function(e){t.removeClass("um-visible-overlay"),show_Modal(e),responsive_Modal(),um_responsive(),wp.UM.profile_completeness.popup.init_plugins(t)},error:function(e){remove_Modal(),console.error(e)}}):(wp.UM.profile_completeness.is_profile_changed&&0<jQuery("div.um-profile").length&&location.reload(),remove_Modal()),!1}},init:function(){wp.UM.profile_completeness.widget.wrapper=jQuery(".um-completeness-widget-wrapper"),wp.UM.profile_completeness.widget.wrapper.length&&wp.UM.profile_completeness.widget.wrapper.each(function(){wp.UM.profile_completeness.widget.build(jQuery(this).parents(".um-completeness-widget"))}),jQuery(document.body).on("click",".um-completeness-save a.skip",function(e){e.preventDefault(),wp.UM.profile_completeness.popup.skip(jQuery(this).parents(".um-popup"))}),jQuery(document.body).on("click",".um-completeness-save a.save",function(e){e.preventDefault(),wp.UM.profile_completeness.popup.save(jQuery(this).parents(".um-popup"))}),jQuery(document.body).on("click",".um-completeness-edit",function(e){var t=jQuery(this);t.hasClass("um-real-url")||wp.UM.profile_completeness.popup.load(t)}),jQuery(document.body).on("click",'body.um-own-profile a[data-modal="um_upload_single"]',function(e){var t=jQuery(".um-completeness-widget").attr("data-user_id");t&&jQuery("#um_upload_single").attr("data-user_id",t)}),jQuery(document.body).on("click",".um-popup-overlay",function(e){if(wp.UM.profile_completeness.is_profile_changed){var t=jQuery(e.currentTarget).siblings("div.um-popup");0<t.length&&0<t.find("div.um-completeness-editwrap").length&&0<jQuery("div.um-profile").length&&location.reload()}})}}),jQuery(document).ready(function(){wp.UM.profile_completeness.init()});