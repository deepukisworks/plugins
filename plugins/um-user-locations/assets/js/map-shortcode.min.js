function UMInitMapShortcode(){jQuery(".um-member-map-shortcode").each(function(){var o=jQuery(this);wp.UM.user_locations.map_shortcode.init(o)})}"object"!=typeof wp.UM&&(wp.UM={}),"object"!=typeof wp.UM.user_locations&&(wp.UM.user_locations={}),wp.UM.user_locations.map_shortcode={infowindow:{customize:function(){var o=jQuery(".gm-style-iw"),a=o.prev();a.children(":nth-child(2)").css({display:"none"}),a.children(":nth-child(4)").css({display:"none"}),o.parent().parent().css({left:"115px"}),a.children(":nth-child(1)").attr("style",function(o,a){return a+"left: 76px !important;"}),a.children(":nth-child(3)").attr("style",function(o,a){return a+"left: 76px !important;"}),a.children(":nth-child(3)").find("div").children().css({"box-shadow":"rgba(72, 181, 233, 0.6) 0px 1px 6px","z-index":"1"});var e=o.next();e.css({opacity:"1",right:"48px",top:"20px","border-radius":"50%"}),e.mouseout(function(){jQuery(this).css({opacity:"1"})})},close:function(o){void 0!==wp.UM.user_locations.map_shortcode.blocks.data&&(void 0!==wp.UM.user_locations.map_shortcode.blocks.data.infowindows&&jQuery.each(wp.UM.user_locations.map_shortcode.blocks.data.infowindows,function(o){wp.UM.user_locations.map_shortcode.blocks.data.infowindows[o].close()}),o&&(wp.UM.user_locations.map_shortcode.blocks.data.infowindows={}))}},get_map:function(){return void 0!==wp.UM.user_locations.map_shortcode.blocks.data&&void 0!==wp.UM.user_locations.map_shortcode.blocks.data.map?wp.UM.user_locations.map_shortcode.blocks.data.map:null},init:function(o){if(!o.hasClass("um-map-inited")){wp.UM.user_locations.map_shortcode.blocks.data=[];var a=new google.maps.LatLng(o.data("lat"),o.data("lng")),e=o.data("zoom"),s=o.data("field");void 0===e&&(e=12);var t=wp.hooks.applyFilters("um_user_locations_map_shortcode_args_init",{center:a,zoom:e,field:s},"data",o);return wp.UM.user_locations.map_shortcode.blocks.data.map=new google.maps.Map(o[0],t),wp.UM.user_locations.map_shortcode.ajax.handler(o,s),o.removeClass(wp.UM.user_locations.map_shortcode.classes.hidden).addClass("um-map-inited"),o}},ajax:{handler:function(a,o){var e={marker_type:a.data("marker_type"),field:o,nonce:um_scripts.nonce};wp.ajax.send("um_get_map_members_data",{data:e,success:function(o){wp.UM.user_locations.map_shortcode.whengoogleloadeddo(wp.UM.user_locations.map_shortcode.ajax.response,[a,o])},error:function(o){console.log(o)}})},response:function(o,c){var i=o.data("field"),n=o.data("field_title"),d={};Object.getOwnPropertyNames(d).forEach(function(o){delete d[o]}),jQuery.each(c.users,function(o){var a=c.users[o];if(void 0===d[a.id]&&(d[a.id]={}),void 0!==a[i+"_lat"]&&void 0!==a[i+"_lng"]){var e=new google.maps.LatLng(a[i+"_lat"],a[i+"_lng"]),s={content:wp.template("um-user-location-map-shortcode-marker-infowindow")({field:i,userdata:a}),maxWidth:350};s=wp.hooks.applyFilters("um_user_locations_infowindow_data",s,"data",a.id);var t,r={position:e,map:wp.UM.user_locations.map_shortcode.get_map(),title:a.display_name+" "+n,zIndex:o+1,optimized:!1,infowindow:s};if(""!==a.avatar_url)t=-1===a.avatar_url.indexOf("?")?"?um_avatar_marker=1":"&um_avatar_marker=1",r.icon={url:a.avatar_url+t,scaledSize:new google.maps.Size(32,32),size:new google.maps.Size(36,40),anchor:new google.maps.Point(18,18)},r.shape={coords:[18,18,20],type:"circle"};r=wp.hooks.applyFilters("um_user_locations_marker_data",r,"data",a),d[a.id]=r}}),void 0===wp.UM.user_locations.map_shortcode.blocks.data.markers&&(wp.UM.user_locations.map_shortcode.blocks.data.markers={}),void 0===wp.UM.user_locations.map_shortcode.blocks.data.infowindows&&(wp.UM.user_locations.map_shortcode.blocks.data.infowindows={}),void 0!==wp.UM.user_locations.map_shortcode.blocks.data.marker_clusterer&&wp.UM.user_locations.map_shortcode.blocks.data.marker_clusterer.clearMarkers(),jQuery.each(d,function(a){void 0===wp.UM.user_locations.map_shortcode.blocks.data.markers[a]&&(wp.UM.user_locations.map_shortcode.blocks.data.markers[a]={}),void 0===wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a]&&(wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a]={}),wp.UM.user_locations.map_shortcode.blocks.data.markers[a]=new google.maps.Marker(d[a]),wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a]=new google.maps.InfoWindow(d[a].infowindow),wp.UM.user_locations.map_shortcode.blocks.data.markers[a].addListener("click",function(o){void 0!==o?(wp.UM.user_locations.map_shortcode.infowindow.close(),wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a].status="open",wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a].open(wp.UM.user_locations.map_shortcode.get_map(),wp.UM.user_locations.map_shortcode.blocks.data.markers[a])):wp.UM.user_locations.map_shortcode.infowindow.close()}),google.maps.event.addListener(wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a],"closeclick",function(){wp.UM.user_locations.map_shortcode.blocks.data.infowindows[a].status="closed"})}),wp.hooks.doAction("um_member_directory_after_markers_init",!1,d);var a=!1;if(!(a=wp.hooks.applyFilters("um_map_shortcode_disable_spiderfier",a))){var e=new OverlappingMarkerSpiderfier(wp.UM.user_locations.map_shortcode.get_map(),{keepSpiderfied:!0,event:"mouseover"}),s=[];void 0!==wp.UM.user_locations.map_shortcode.blocks.data.markers&&jQuery.each(wp.UM.user_locations.map_shortcode.blocks.data.markers,function(o){s.push(wp.UM.user_locations.map_shortcode.blocks.data.markers[o]),e.addMarker(wp.UM.user_locations.map_shortcode.blocks.data.markers[o])}),e.addListener("spiderfy",function(o){void 0!==wp.UM.user_locations.map_shortcode.blocks.data.infowindows&&jQuery.each(wp.UM.user_locations.map_shortcode.blocks.data.infowindows,function(o){wp.UM.user_locations.map_shortcode.blocks.data.infowindows[o].close()})}),e.addListener("unspiderfy",function(o){void 0!==wp.UM.user_locations.map_shortcode.blocks.data.infowindows&&jQuery.each(wp.UM.user_locations.map_shortcode.blocks.data.infowindows,function(o){wp.UM.user_locations.map_shortcode.blocks.data.infowindows[o].close()})})}var t=!1;if(!(t=wp.hooks.applyFilters("um_map_shortcode_disable_clustering",t))){var r=wp.hooks.applyFilters("um_user_locations_marker_clustering_options",{imagePath:um_user_location_map_shortcode.cluster_url},"data",wp.UM.user_locations.map_shortcode.get_map(),s);wp.UM.user_locations.map_shortcode.blocks.data.marker_clusterer=new MarkerClusterer(wp.UM.user_locations.map_shortcode.get_map(),s,r),wp.UM.user_locations.map_shortcode.blocks.data.marker_clusterer.setMaxZoom(20),google.maps.event.addListener(wp.UM.user_locations.map_shortcode.blocks.data.marker_clusterer,"clusterclick",function(o){var a=o.getMarkers()[0];setTimeout(function(){google.maps.event.trigger(a,"click")},1e3)})}}},whengoogleloadeddo:function(a,e){"undefined"!=typeof google?a(e[0],e[1]):setTimeout(function(){var o;o=a,wp.UM.user_locations.map_shortcode.whengoogleloadeddo(o,e)},500)},blocks:[],classes:{hidden:"um-user-location-hidden-map"}};var um_ul_script=document.createElement("script");um_ul_script.src="//maps.googleapis.com/maps/api/js?key="+um_user_location_map_shortcode.api_key+"&libraries=places&callback=UMInitMapShortcode",um_user_location_map_shortcode.region&&(um_ul_script.src+="&language="+um_user_location_map_shortcode.region),document.body.appendChild(um_ul_script);