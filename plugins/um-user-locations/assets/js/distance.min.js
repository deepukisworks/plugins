jQuery(document).ready(function(){if(jQuery("#um-user-location-current-lat").length&&navigator.geolocation){navigator.geolocation.getCurrentPosition(function(n){jQuery("#um-user-location-current-lat").val(n.coords.latitude),jQuery("#um-user-location-current-lng").val(n.coords.longitude),jQuery(".um-field-distance, .um-distance-meta").each(function(){var e=jQuery(this).find(".um-user-location-distance-calculation-result"),n=e.data("location_source");wp.ajax.send("um_get_user_distance",{data:{location:[jQuery("#um-user-location-current-lat").val(),jQuery("#um-user-location-current-lng").val()],user_coords:[jQuery("#um-user-location-distance-"+n+"-lat").val(),jQuery("#um-user-location-distance-"+n+"-lng").val()],unit:e.data("distance_unit"),nonce:um_scripts.nonce},success:function(n){e.text(n)},error:function(n){console.log(n)}})})},function(n){(n.code=n.PERMISSION_DENIED)&&jQuery("#um-user-location-current-denied").val(1)})}}),wp.hooks.addFilter("um_member_directory_get_members_allow","um_user_locations_distance",function(n,e,r){return r.find("#um-user-location-current-lat").length&&r.find("#um-user-location-current-lng").length&&(1===parseInt(r.find("#um-user-location-current-denied").val(),10)||""!==r.find("#um-user-location-current-lat").val()&&""!==r.find("#um-user-location-current-lng").val()||(n=!1)),n},10),wp.hooks.addFilter("um_member_directory_filter_request","um_user_locations",function(n){var e=jQuery('.um-directory[data-hash="'+n.directory_id+'"]');if(!e.length)return n;if(!e.find("#um-user-location-current-lat").length||!e.find("#um-user-location-current-lng").length)return n;if(""!==e.find("#um-user-location-current-lat").val()&&""!==e.find("#um-user-location-current-lng").val()){var r=e.find("#um-user-location-current-lat").val(),t=e.find("#um-user-location-current-lng").val();n.current_user_location=[r,t]}return n},10);